!function(exports){"use strict";var movvizApp=angular.module("movvizApp",["ngRoute","movvizControllers"]);movvizApp.config(["$routeProvider",function($routeProvider){$routeProvider.when("/movies",{templateUrl:"partial/movie-list",controller:"MovvizListCtrl"}).when("/movies/:page",{templateUrl:"partial/movie-list",controller:"MovvizListCtrl"}).when("/movies/:search/:page",{templateUrl:"partial/movie-list",controller:"MovvizListCtrl"}).when("/movie/:id?",{templateUrl:"partial/movie-detail",controller:"MovvizDetailCtrl"}).otherwise({redirectTo:"/movies"})}]).directive("stopEvent",function(){return{restrict:"A",link:function(scope,element,attr){element.bind(attr.stopEvent,function(e){e.stopPropagation()})}}}).directive("disabledLink",function(){return{link:function(scope,element,attr){element.on("click",function(e){e.preventDefault()})}}})}(window),function(exports){"use strict";var movvizControllers=angular.module("movvizControllers",[]);movvizControllers.controller("MovvizListCtrl",["$scope","$http","$routeParams","$window",function($scope,$http,$routeParams,$window){var page=parseInt($routeParams.page,10);$scope.searchPattern=$routeParams.search,!$routeParams.search&&$routeParams.page&&(isNaN(page)||page%1)?(page=0,$scope.searchPattern=$routeParams.page):isNaN(page)||page%1?page=0:page--;var apiUrl=($scope.movies=[],"/api/movies/");$scope.searchPattern&&(apiUrl+=encodeURIComponent($scope.searchPattern)+"/"),apiUrl+=page,$http.get(apiUrl).success(function(data,status,headers,config){$scope.movies=data.movies,$scope.currentPage=data.pagination.currentPage,$scope.totalPages=data.pagination.totalPages}).error(function(data,status,headers,config){console.log("error")}),$scope.searchPattern&&($scope.searchPatternForm=$scope.searchPattern),$scope.range=function(){for(var rangeSize=10,ret=[],start=Math.max(0,Math.ceil($scope.currentPage-rangeSize/2)),max=Math.min($scope.totalPages,start+rangeSize),i=start;max>i;i++)ret.push(i);return ret},$scope.prevPageDisabled=function(){return $scope.currentPage?"":"disabled"},$scope.nextPageDisabled=function(){return $scope.currentPage===$scope.totalPages-1?"disabled":""},$scope["goto"]=function(page){page=page||1;var target="#/movies/";return this.searchPattern&&(target+=encodeURIComponent(this.searchPattern)+"/"),page&&(target+=page+"/"),$window.location.href=target,!1},$scope.search=function(){this.searchPattern=this.searchPatternForm,this["goto"]()},$scope.$on("$viewContentLoaded",function(){$("#movie-list .form > form").affix({offset:{top:0}})})}]),movvizControllers.controller("MovvizDetailCtrl",["$scope","$http","$routeParams",function($scope,$http,$routeParams){$http.get("/api/movie/"+$routeParams.id).success(function(data,status,headers,config){$scope.movie=data}).error(function(data,status,headers,config){console.log("error")})}])}(window);
//# sourceMappingURL=movviz.min.js.map